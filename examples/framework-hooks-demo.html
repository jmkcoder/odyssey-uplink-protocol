<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odyssey Uplink Protocol - Framework Hooks Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            line-height: 1.5;
        }
        .demo-section {
            margin-bottom: 2rem;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 0.5rem;
        }
        h2 {
            margin-top: 0;
        }
        pre {
            background-color: #f6f8fa;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
        }
        .counter {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 1rem 0;
        }
        button {
            padding: 0.5rem 1rem;
            background-color: #0078d4;
            color: white;
            border: none;
            border-radius: 0.25rem;
            cursor: pointer;
        }
        button:hover {
            background-color: #106ebe;
        }
        .count {
            font-size: 1.5rem;
            font-weight: bold;
            min-width: 3rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>Odyssey Uplink Protocol - Framework Hooks Demo</h1>
    <p>
        This demo shows how to use the framework hooks provided by the Odyssey Uplink Protocol.
        The protocol auto-detects your framework environment and provides an appropriate API.
    </p>

    <div class="demo-section">
        <h2>Auto-Detected Framework</h2>
        <div id="framework-info">Detecting framework...</div>
        <pre id="framework-code"></pre>
    </div>

    <div class="demo-section">
        <h2>Counter Demo</h2>
        <p>A simple counter implemented using the appropriate framework hook:</p>
        <div id="counter-demo" class="counter">
            <button id="decrement">-</button>
            <div id="count" class="count">0</div>
            <button id="increment">+</button>
        </div>
        <pre id="counter-code"></pre>
    </div>

    <!-- Import the Uplink Protocol -->
    <script src="../dist/index.js"></script>
    <script>
        // Display detected framework
        document.addEventListener('DOMContentLoaded', () => {
            // Debug what's available
            const availableGlobals = [];
            if (window.UplinkProtocol) availableGlobals.push('UplinkProtocol');
            console.log('Available library globals:', availableGlobals);
            console.log('UplinkProtocol object:', window.UplinkProtocol);
            
            // Check if UplinkProtocol is available
            if (!window.UplinkProtocol) {
                document.getElementById('framework-info').textContent = 'UplinkProtocol library not loaded. Make sure the dist/index.js file is built.';
                return;
            }
            
            const framework = UplinkProtocol.detectFramework();
            document.getElementById('framework-info').textContent = `Detected framework: ${framework}`;
            
            // Show code example for the detected framework
            showFrameworkCodeExample(framework);
            
            // Initialize the counter demo
            initCounterDemo(framework);
        });

        function showFrameworkCodeExample(framework) {
            let code = '';
            switch (framework) {
                case 'react':
                    code = "import { ReactIntegration } from '@jmkcoder/uplink';\n" +
                           "import CounterController from './counter.controller';\n\n" +
                           "function Counter() {\n" +
                           "  const { state, methods, Container } = ReactIntegration.useUplink(new CounterController());\n\n" +
                           "  return (\n" +
                           "    <Container>\n" +
                           "      <button onClick={methods.decrement}>-</button>\n" +
                           "      <div className=\"count\">{state.count}</div>\n" +
                           "      <button onClick={methods.increment}>+</button>\n" +
                           "    </Container>\n" +
                           "  );\n" +
                           "}";
                    break;
                case 'vue':
                    code = "<template>\n" +
                           "  <Container>\n" +
                           "    <button @click=\"methods.decrement\">-</button>\n" +
                           "    <div class=\"count\">{{ state.count }}</div>\n" +
                           "    <button @click=\"methods.increment\">+</button>\n" +
                           "  </Container>\n" +
                           "</template>\n\n" +
                           "<script>\n" +
                           "import { VueIntegration } from '@jmkcoder/uplink';\n" +
                           "import CounterController from './counter.controller';\n\n" +
                           "export default {\n" +
                           "  setup() {\n" +
                           "    const { state, methods, Container } = VueIntegration.useUplink(new CounterController());\n" +
                           "    return { state, methods, Container };\n" +
                           "  }\n" +
                           "}\n" +
                           "<\\/script>";
                    break;
                case 'angular':
                    code = "import { Component, OnInit } from '@angular/core';\n" +
                           "import { AngularIntegration } from '@jmkcoder/uplink';\n" +
                           "import { CounterController } from './counter.controller';\n\n" +
                           "@Component({\n" +
                           "  selector: 'app-counter',\n" +
                           "  template: `\n" +
                           "    <div>\n" +
                           "      <button (click)=\"decrement()\">-</button>\n" +
                           "      <div class=\"count\">{{ count }}</div>\n" +
                           "      <button (click)=\"increment()\">+</button>\n" +
                           "    </div>\n" +
                           "  `\n" +
                           "})\n" +
                           "export class CounterComponent implements OnInit {\n" +
                           "  count = 0;\n" +
                           "  private controller: CounterController;\n\n" +
                           "  ngOnInit() {\n" +
                           "    this.controller = AngularIntegration.useController(new CounterController(), this);\n" +
                           "  }\n\n" +
                           "  increment() {\n" +
                           "    this.controller.methods.increment();\n" +
                           "  }\n\n" +
                           "  decrement() {\n" +
                           "    this.controller.methods.decrement();\n" +
                           "  }\n" +
                           "}";
                    break;
                case 'svelte':
                    code = "<script>\n" +
                           "  import { SvelteIntegration } from '@jmkcoder/uplink';\n" +
                           "  import CounterController from './counter.controller';\n\n" +
                           "  const { controller, stores, methods, state } = SvelteIntegration.getController(new CounterController());\n" +
                           "  $: count = $stores.count;\n" +
                           "<\\/script>\n\n" +
                           "<div use:SvelteIntegration.connectElement={controller}>\n" +
                           "  <button on:click={methods.decrement}>-</button>\n" +
                           "  <div class=\"count\">{count}</div>\n" +
                           "  <button on:click={methods.increment}>+</button>\n" +
                           "</div>";
                    break;                default:
                    code = "// Vanilla JavaScript\n" +
                           "import { initializeVanillaAdapter, connectController, disconnectController } from '@uplink-protocol/core';\n" +
                           "import CounterController from './counter.controller';\n\n" +
                           "// Initialize the vanilla adapter\n" +
                           "initializeVanillaAdapter();\n\n" +
                           "const controller = new CounterController();\n" +
                           "const element = document.getElementById('counter');\n\n" +
                           "connectController(controller, element);\n\n" +
                           "document.getElementById('increment').addEventListener('click', () => {\n" +
                           "  controller.methods.increment();\n" +
                           "});\n\n" +
                           "document.getElementById('decrement').addEventListener('click', () => {\n" +
                           "  controller.methods.decrement();\n" +
                           "});";
            }
            
            document.getElementById('framework-code').textContent = code;
        }

        // CounterController class
        class CounterController {
            constructor() {
                this.bindings = {
                    count: {
                        current: 0,
                        subscribe: function(callback) {
                            this._callback = callback;
                            return () => { this._callback = null; };
                        },
                        set: function(value) {
                            this.current = value;
                            if (this._callback) this._callback(value);
                        }
                    }
                };
                
                this.methods = {
                    increment: () => {
                        this.bindings.count.set(this.bindings.count.current + 1);
                    },
                    decrement: () => {
                        this.bindings.count.set(this.bindings.count.current - 1);
                    }
                };
            }
        }

        function initCounterDemo() {
            const controller = new CounterController();
            const element = document.getElementById('counter-demo');
            const countElement = document.getElementById('count');
            
            // Connect controller to element
            UplinkProtocol.connectController(controller, element);
            
            // Set up event listeners
            document.getElementById('increment').addEventListener('click', () => {
                controller.methods.increment();
            });
            
            document.getElementById('decrement').addEventListener('click', () => {
                controller.methods.decrement();
            });
            
            // Subscribe to count changes
            controller.bindings.count.subscribe(value => {
                countElement.textContent = value;
            });
            
            // Show code for the vanilla implementation
            document.getElementById('counter-code').textContent = `// Controller implementation
class CounterController {
    constructor() {
        this.bindings = {
            count: {
                current: 0,
                subscribe: function(callback) {
                    this._callback = callback;
                    return () => { this._callback = null; };
                },
                set: function(value) {
                    this.current = value;
                    if (this._callback) this._callback(value);
                }
            }
        };
        
        this.methods = {
            increment: () => {
                this.bindings.count.set(this.bindings.count.current + 1);
            },
            decrement: () => {
                this.bindings.count.set(this.bindings.count.current - 1);
            }
        };
    }
}`;
        }
    </script>
</body>
</html>
<!-- This HTML file demonstrates the use of the @jmkcoder/uplink Uplink Protocol with various frameworks. 
     It includes a simple counter example and shows how to use the protocol's hooks for different frameworks. -->
